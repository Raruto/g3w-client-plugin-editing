<div style="border: 2px solid rgba(60, 141, 188, 0.1); margin-bottom: 5px; border-radius: 3px;">
  <div class="box-header with-border" style="margin-button:3px; background-color: #ffffff; ">
    <div class="container" style="width:100%">
      <div class="row">
        <div class="col-lg-10 col-sm-12">
          <h5 class="relation_title">{{ relation.name }}</h5>
        </div>
        <div class="col-lg-1 col-sm-6 add-link"
               data-toggle="tooltip" data-placement="bottom"
               :title="tooltips.add_relation" @click="enableAddLinkButtons ? addRelationAndLink() : null">
            <span  class="g3w-icon g3w-plus"  :class="{'disabled' : !enableAddLinkButtons }"></span>
          </div>
        <div class="col-md-1 col-sm-6 add-link"
               data-toggle="tooltip" data-placement="bottom"
               :title="tooltips.link_relation" @click="enableAddLinkButtons ? linkRelation() : null">
            <span  class="g3w-icon g3w-link" style="font-size:20px;" :class="{'disabled': !enableAddLinkButtons}"></span>
          </div>
      </div>
    </div>
  </div>
  <div class="box-body" style="padding:0px;">
    <template v-if="relationsLength">
      <table class="table table-striped">
        <thead>
          <tr>
            <th v-for="attribute in relationAttributesSubset(relations[0])">
              {{attribute.label}}
            </th>
            <th></th>
            <th></th>
            <th></th>
          </tr>
          </thead>
          <tbody>
            <tr v-for="(relation, index) in relations" class="featurebox-header">
              <td v-show="!showAllFieds(index)" v-for="attribute in relationAttributesSubset(relation)">
                <span>{{ getValue(attribute.value) }}</span>
              </td>
              <td v-show="showAllFieds(index)" :colspan="relationsAttributesSubsetLength(relation)">
                <table style="background:none !important;">
                  <tr v-for="field in relationsFields(relation)">
                    <td class="attr-label">{{field.label}}</td>
                    <td class="attr-value">
                      <span>{{ getValue(field.value) }}</span>
                  </td>
                  </tr>
                </table>
              </td>
              <td class="action-cell">
                <span
                  @click="showAllRelationFields(index)"
                  style="color:#3c8dbc; cursor:pointer;" class="fa link morelink"
                  :class="[showallfieldsindex == index ? 'fa-minus': 'fa-ellipsis-h' ]">
                </span>
              </td>
              <td>
                <span
                  v-if="!fieldrequired"
                  class="g3w-mini-relation-icon g3w-icon g3w-unlink pull-right "
                  @click="unlinkRelation(index)"
                  data-toggle="tooltip" data-placement="bottom" :title="tooltips.unlink_relation"
                  aria-hidden="true">
                </span>
              </td>
              <td>
                <div class="dropup">
                  <span
                    data-toggle="dropdown" data-placement="bottom" :title="tooltips.open_relation_tool"
                    aria-haspopup="true" aria-expanded="false"
                    class="dropdown-toggle g3w-icon g3w-mini-relation-icon g3w-cogs pull-right g3w-relation-tools"
                    aria-hidden="true">
                  </span>
                  <div class="dropdown-menu pull-right" style="margin-bottom:5px; box-shadow: 3px 3px 3px rgba(0, 0, 0, 0.5) !important;" :style="{'min-width': getRelationTools().length*40 + 'px !important' }">
                    <div @click="startTool(relationtool, index)"
                         v-for="relationtool in getRelationTools()"
                         data-toggle="tooltip"
                         data-placement="bottom" :title="relationtool.state.name"
                         class="editbtn enabled" style="display:inline-block">
                      <img height="20px" width="20px" :src="resourcesurl + 'images/'+ relationtool.state.icon"/>
                    </div>
                  </div>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </template>
    </div>
</div>
